---
import Header from "@/components/Header.jsx";
import Layout from "@l/Layout.astro";
import { User, db, eq } from "astro:db";
import noUserImage from "../../public/img/noUserImage.png"

const headerLinks = [
  { href: "/pamShare", content: "Pam Share" },
  { href: "/myWardrobe", content: "My Wardrobe" },
  { href: "/#about", content: "About Us" },
];

const user = Astro.locals.user;
let dbUser = null;
if (user) {
  dbUser = (await db.select().from(User).where(eq(User.id, user.id))).at(0);
} else {
  return Astro.redirect("/logIn");
}
---

<Layout
  title="PAME - My Profile"
  desc="Design you PAME profile and Share it with yoour Friends!!"
>
  <Header client:load headerLinks={headerLinks} user={user} show={true} />
  {
    dbUser ? (
      <h1 class="text-center text-2xl mt-10">{dbUser.username}</h1>      
      <p class="text-center">{dbUser.description}</p>
      <a class="text-blue-300 hover:text-green-500 text-center" href={dbUser.link}>{dbUser.link}</a>
    ) : (
      <h1 class="text-center text-2xl mt-10">No User Found</h1>
    )
  }
  {
    (dbUser&&dbUser.imageUrl) ? (
      <img class="w-56 mx-auto bg-slate-100/50 aspect-square rounded-full m-5"src={dbUser.imageUrl}/>
    ):(
      <img class="w-56 mx-auto bg-slate-100/50 aspect-square rounded-full m-5"src={noUserImage.src} />
    )
  }
</Layout>
